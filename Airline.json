{"paragraphs":[{"text":"%spark2.pyspark\n\n##///노선별 실제와 예상 비행시간 차이\n\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.functions import date_format\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\ndf=spark.read.csv(\"hdfs:///user/maria_dev/pro/2008resultfull.csv\", header=True, inferSchema=True)\n#df = df.withColumn(\"Line\", df.Origin + df.Dest)\n#df= df.groupBy(\"Line\").agg(F.mean('ElapsedTimeDelay').alias(\"ETDM\")).sort(F.desc(\"ETDM\"))\n#df['Line'] = df['Origin'] + \" \" + df['Dest']\nresult_df = df.groupBy(\"Origin\",\"Dest\").agg(F.mean(\"ElapsedTimeDelay\").alias(\"ETDM\"))\nz.show(result_df)","user":"anonymous","dateUpdated":"2022-12-07T05:59:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{"columns":[{"name":"Origin","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Dest","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"ETDM","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Origin":"string","Dest":"string","ETDM":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[{"name":"Origin","index":0,"aggr":"sum"},{"name":"Dest","index":1,"aggr":"sum"}],"values":[{"name":"ETDM","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Origin\tDest\tETDM\nLAS\tORD\t82.61807228915663\nPHX\tDFW\t200.46311010215663\nLAX\tDFW\t192.6946050096339\nSLC\tIAH\t235.41015625\nIAH\tDEN\t4.807637906647807\nPHX\tATL\t-40.06122448979592\nPHX\tDTW\t-188.3875\nLAS\tSLC\t-37.42827004219409\nATL\tORD\t-11.647007042253522\nDFW\tORD\t91.51782820097245\nPHX\tIAH\t10.016460905349794\nDEN\tIAH\t188.91347517730497\nATL\tIAH\t-6.084407971864009\nDFW\tSLC\t19.46303501945525\nLAX\tIAH\t322.8112244897959\nDTW\tDEN\t-73.64495798319328\nIAH\tDFW\t40.53238199780461\nDFW\tDEN\t-19.446293494704992\nDTW\tLAS\t-124.07142857142857\nLAS\tDTW\t-681.4852071005918\nSLC\tPHX\t60.266768292682926\nPHX\tORD\t24.198317307692307\nATL\tDEN\t-67.1884531590414\nSLC\tATL\t321.52702702702703\nDEN\tDTW\t67.46218487394958\nORD\tDTW\t143.27272727272728\nDEN\tLAS\t-22.509130752373995\nORD\tDEN\t5.316877152698048\nATL\tLAS\t-147.69331585845347\nLAS\tPHX\t25.057620817843866\nDTW\tIAH\t20.780392156862746\nATL\tPHX\t-66.03008423586041\nPHX\tLAS\t-45.10126582278481\nIAH\tLAS\t-152.42921348314607\nORD\tATL\t176.8099173553719\nLAS\tDEN\t68.22076978939724\nLAX\tPHX\t71.97427652733118\nDTW\tORD\t-54.204873646209386\nDFW\tIAH\t37.721672167216724\nIAH\tATL\t179.60419235511714\nDEN\tLAX\t-0.9632034632034632\nORD\tDFW\t99.28881737731295\nDFW\tATL\t89.0879048248513\nPHX\tSLC\t66.93333333333334\nDFW\tPHX\t11.222850678733032\nATL\tSLC\t-27.8639846743295\nDEN\tORD\t152.58484162895928\nATL\tDTW\t80.98614318706697\nLAX\tDEN\t185.67957746478874\nDTW\tSLC\t-39.7\nLAS\tATL\t29.632275132275133\nLAS\tDFW\t182.26793721973095\nSLC\tLAX\t-21.97532188841202\nDEN\tATL\t312.9917355371901\nDFW\tLAS\t-85.41394825646795\nORD\tIAH\t107.56801007556675\nSLC\tDFW\t204.80776699029127\nDTW\tATL\t72.70323325635104\nIAH\tLAX\t-110.83473861720067\nPHX\tDEN\t-22.980364656381486\nIAH\tSLC\t28.889546351084814\nLAX\tSLC\t39.17334777898158\nDFW\tLAX\t-67.72447013487476\nLAX\tATL\t-27.850641773628936\nLAS\tLAX\t-6.0288329519450805\nORD\tPHX\t55.25714285714286\nATL\tLAX\t-112.09101516919486\nLAS\tIAH\t210.8918918918919\nPHX\tLAX\t-38.19117647058823\nDEN\tDFW\t175.7653292959879\nDTW\tLAX\t-107.01538461538462\nIAH\tORD\t103.43946731234867\nDTW\tDFW\t10.17056074766355\nIAH\tDTW\t207.8515625\nDEN\tPHX\t78.31232294617564\nLAX\tDTW\t-389.95541401273886\nLAX\tORD\t-4.853790613718411\nDTW\tPHX\t-21.96638655462185\nLAX\tLAS\t42.604835164835166\nORD\tLAS\t-41.987893462469735\nSLC\tORD\t215.7947598253275\nDFW\tDTW\t205.05868544600938\nSLC\tDTW\t315.1666666666667\nSLC\tDEN\t52.96282293635791\nORD\tSLC\t41.6057268722467\nIAH\tPHX\t1.4132231404958677\nDEN\tSLC\t59.073587385019714\nATL\tDFW\t-45.41164791528789\nORD\tLAX\t-37.72426817752597\nSLC\tLAS\t-52.36638830897704\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=0","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=1","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=2","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=3","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=4","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=5","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=6"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1670051735272_208669429","id":"20221203-071535_1410569796","dateCreated":"2022-12-03T07:15:35+0000","dateStarted":"2022-12-03T12:14:24+0000","dateFinished":"2022-12-03T12:15:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6425"},{"text":"%spark2.pyspark\n##//운항 노선 갯수 출발지별\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.functions import date_format\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\ndf=spark.read.csv(\"hdfs:///user/maria_dev/pro/2008resultfull.csv\", header=True, inferSchema=True)\n#df = df.withColumn(\"Line\", df.Origin + df.Dest)\n#df= df.groupBy(\"Line\").agg(F.mean('ElapsedTimeDelay').alias(\"ETDM\")).sort(F.desc(\"ETDM\"))\n#df['Line'] = df['Origin'] + \" \" + df['Dest']\nresult_df = df.groupBy(\"Origin\").agg(F.count(\"ElapsedTimeDelay\").alias(\"ETDC\")).sort(\"ETDC\")\nresult_df1 = df.groupBy(\"Origin\").agg(F.mean(\"ElapsedTimeDelay\").alias(\"ETDM\")).sort(\"ETDM\")\n\nresult_df2 = result_df.join(result_df1,result_df1[\"Origin\"]==result_df[\"Origin\"])\n\nresult_df2 = result_df2.sort(\"ETDC\")\n\n\n\nz.show(result_df2)","user":"anonymous","dateUpdated":"2022-12-07T05:59:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Origin":"string","ETDC":"string","ETDM":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Origin","index":0,"aggr":"sum"},{"name":"ETDC","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"ETDM","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Origin\tETDC\tOrigin\tETDM\nDTW\t4520\tDTW\t-22.024778761061945\nIAH\t6038\tIAH\t43.054157005631005\nSLC\t6852\tSLC\t87.97066549912434\nATL\t8257\tATL\t-43.20588591498123\nORD\t8287\tORD\t67.07505731869193\nDFW\t8729\tDFW\t24.90010310459388\nLAS\t9922\tLAS\t21.77595242894578\nDEN\t10043\tDEN\t99.93826545852833\nLAX\t10389\tLAX\t74.03888728462798\nPHX\t10527\tPHX\t-3.0514866533675313\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=146","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=147","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=148","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=149","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=150","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=151"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1670060168323_-1642815441","id":"20221203-093608_1498806342","dateCreated":"2022-12-03T09:36:08+0000","dateStarted":"2022-12-05T03:14:42+0000","dateFinished":"2022-12-05T03:14:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6426"},{"text":"%spark2.pyspark\n##//운항 노선 갯수 출발지별\nfrom pyspark.sql.functions import *\nfrom pyspark.sql.functions import date_format\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\ndf=spark.read.csv(\"hdfs:///user/maria_dev/pro/2008resultfull.csv\", header=True, inferSchema=True)\n#df = df.withColumn(\"Line\", df.Origin + df.Dest)\n#df= df.groupBy(\"Line\").agg(F.mean('ElapsedTimeDelay').alias(\"ETDM\")).sort(F.desc(\"ETDM\"))\n#df['Line'] = df['Origin'] + \" \" + df['Dest']\nresult_df = df.groupBy(\"Dest\").agg(F.count(\"ElapsedTimeDelay\").alias(\"ETDC\")).sort(\"ETDC\")\nresult_df1 = df.groupBy(\"Dest\").agg(F.mean(\"ElapsedTimeDelay\").alias(\"ETDM\")).sort(\"ETDM\")\n\nresult_df2 = result_df.join(result_df1,result_df1[\"Dest\"]==result_df[\"Dest\"])\n\nresult_df2 = result_df2.sort(\"ETDC\")\n\n\n\nz.show(result_df2)","user":"anonymous","dateUpdated":"2022-12-07T05:59:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Dest":"string","ETDC":"string","ETDM":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Dest","index":0,"aggr":"sum"},{"name":"ETDC","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"ETDM","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Dest\tETDC\tDest\tETDM\nDTW\t4583\tDTW\t6.740781147719834\nIAH\t6044\tIAH\t110.78275976174719\nSLC\t6770\tSLC\t30.361890694239293\nATL\t8211\tATL\t118.21288515406162\nORD\t8416\tORD\t52.53457699619772\nDFW\t8740\tDFW\t111.32116704805492\nLAS\t9915\tLAS\t-41.30287443267776\nDEN\t10104\tDEN\t29.144398258115597\nLAX\t10282\tLAX\t-39.89116903326201\nPHX\t10499\tPHX\t35.23297456900657\n"},{"type":"TEXT","data":"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=2","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=3","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=4","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=5","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=6","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=7"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1670209395949_-353330176","id":"20221205-030315_1373367465","dateCreated":"2022-12-05T03:03:15+0000","dateStarted":"2022-12-07T05:57:21+0000","dateFinished":"2022-12-07T05:57:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6427"},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2022-12-07T05:57:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1670392641182_283838853","id":"20221207-055721_94821395","dateCreated":"2022-12-07T05:57:21+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6428"}],"name":"Airline","id":"2HK7NT5K6","noteParams":{},"noteForms":{},"angularObjects":{"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}